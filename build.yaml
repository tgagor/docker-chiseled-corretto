---
prefix: tgagor
maintainer: Tomasz GÄ…gor <https://gagor.pro>

labels:
  org.opencontainers.image.vendor: https://gagor.pro
  org.opencontainers.image.licenses: Apache-2.0-only
  org.opencontainers.image.url: https://hub.docker.com/u/tgagor
  org.opencontainers.image.documentation: https://my.url/docshttps://github.com/tgagor/docker-chiseled-corretto/blob/main/README.md
  org.opencontainers.image.title: Amazon's Corretto JDK and JRE images in chiseled variant
  org.opencontainers.image.description: |
    This is a Proof of Concept, to use Cannonical's Chisel tool
    to build super light Amazon Corretto JRE images.

    https://github.com/canonical/chisel
    https://aws.amazon.com/corretto/

images:
  base-alpine:
    dockerfile: base/alpine/Dockerfile
    variables:
      alpine:
        - "3.21"
    args:
      BASE_IMAGE: "alpine:{{ .alpine }}"
    tags:
      - corretto-base:{{ .tag }}-alpine{{ .alpine }}
      - corretto-base:alpine{{ .alpine }}
      - corretto-base:{{ .tag }}-alpine{{ .alpine | splitList "." | first }}
      - corretto-base:alpine{{ .alpine | splitList "." | first }}
      - corretto-base:{{ .tag }}-alpine
      - corretto-base:{{ .tag }}
      - corretto-base:alpine
      - corretto-base

  base-ubuntu:
    dockerfile: base/ubuntu/Dockerfile
    variables:
      ubuntu:
        - "24.04"
    args:
      BASE_IMAGE: "ubuntu:{{ .ubuntu }}"
    tags:
      - corretto-base:{{ .tag }}-ubuntu{{ .ubuntu }}
      - corretto-base:ubuntu{{ .ubuntu }}
      - corretto-base:{{ .tag }}-ubuntu
      - corretto-base:{{ .tag }}
      - corretto-base:ubuntu
      - corretto-base

  jdk-alpine:
    dockerfile: jdk/alpine/Dockerfile
    variables:
      alpine:
        - "3.21"
      java:
        - 11
        - 17
        - 21
    args:
      BASE_IMAGE: "{{ if .registry }}{{ .registry }}/{{ end }}{{ if .prefix }}{{ .prefix }}/{{ end }}base:alpine{{ .alpine }}"
    tags:
      - corretto-jdk:{{ .tag }}-{{ .java }}-alpine{{ .alpine }}
      - corretto-jdk:{{ .java }}-alpine{{ .alpine }}
      - corretto-jdk:{{ .java }}-alpine{{ .alpine | splitList "." | first }}
      - corretto-jdk:{{ .tag }}-{{ .java }}-alpine
      - corretto-jdk:{{ .tag }}-{{ .java }}
      - corretto-jdk:{{ .java }}-alpine
      - corretto-jdk:{{ .java }}
      - corretto-jdk:{{ .tag }}
      - corretto-jdk

  jdk-ubuntu:
    dockerfile: jdk/ubuntu/Dockerfile
    variables:
      ubuntu:
        - "24.04"
      java:
        - 11
        - 17
        - 21
    args:
      BASE_IMAGE: "{{ if .registry }}{{ .registry }}/{{ end }}{{ if .prefix }}{{ .prefix }}/{{ end }}base:ubuntu{{ .ubuntu }}"
    tags:
      - corretto-jdk:{{ .tag }}-{{ .java }}-ubuntu{{ .ubuntu }}
      - corretto-jdk:{{ .java }}-ubuntu{{ .ubuntu }}
      - corretto-jdk:{{ .tag }}-{{ .java }}-ubuntu
      - corretto-jdk:{{ .tag }}-{{ .java }}
      - corretto-jdk:{{ .java }}-ubuntu
      - corretto-jdk:{{ .java }}
      - corretto-jdk:{{ .tag }}
      - corretto-jdk

  jre-alpine:
    dockerfile: jre/alpine/Dockerfile.tpl
    variables:
      alpine:
        - "3.21"
      java:
        - 11
        - 17
        - 21
    tags:
      - corretto-jre:{{ .tag }}-{{ .java }}-alpine{{ .alpine }}
      - corretto-jre:{{ .java }}-alpine{{ .alpine }}
      - corretto-jre:{{ .java }}-alpine{{ .alpine | splitList "." | first }}
      - corretto-jre:{{ .tag }}-{{ .java }}-alpine
      - corretto-jre:{{ .tag }}-{{ .java }}
      - corretto-jre:{{ .java }}-alpine
      - corretto-jre:{{ .java }}
      - corretto-jre:{{ .tag }}
      - corretto-jre

  jre-ubuntu:
    dockerfile: jre/ubuntu/Dockerfile.tpl
    variables:
      ubuntu:
        - "24.04"
      java:
        - 11
        - 17
        - 21
    tags:
      - corretto-jre:{{ .tag }}-{{ .java }}-ubuntu{{ .ubuntu }}
      - corretto-jre:{{ .java }}-ubuntu{{ .ubuntu }}
      - corretto-jre:{{ .tag }}-{{ .java }}-ubuntu
      - corretto-jre:{{ .tag }}-{{ .java }}
      - corretto-jre:{{ .java }}-ubuntu
      - corretto-jre:{{ .java }}
      - corretto-jre:{{ .tag }}
      - corretto-jre

  jre-chiseled:
    dockerfile: jre/chiseled-ubuntu/Dockerfile.tpl
    variables:
      ubuntu:
        - "24.04"
      java:
        - 11
        - 17
        - 21
    args:
      USER: app
      GROUP: app
      UID: 1001
      GID: 1001
    tags:
      - corretto-jre:{{ .tag }}-{{ .java }}-chiseled-ubuntu{{ .ubuntu }}
      - corretto-jre:{{ .java }}-chiseled-ubuntu{{ .ubuntu }}
      - corretto-jre:{{ .tag }}-{{ .java }}-chiseled-ubuntu
      - corretto-jre:{{ .tag }}-{{ .java }}-chiseled
      - corretto-jre:chiseled-{{ .java }}-ubuntu
      - corretto-jre:chiseled-{{ .java }}
      - corretto-jre:{{ .tag }}-chiseled
      - corretto-jre:chiseled
